# 定积分2

## 练习

### 被积函数中含有变限积分函数的定积分计算

**例题 1**

设 $f(x)=\displaystyle\int_{0}^{x} \dfrac{\sin t}{\pi - t} \mathrm{d}t$，计算 $\displaystyle\int_{0}^{\pi} f(x) \mathrm{d}x$

!!! success

    利用分部积分法：

    $$
    \begin{aligned}
    \displaystyle\int_{0}^{\pi} f(x) \mathrm{d}x &= x f(x) \bigg|_{0}^{\pi} - \displaystyle\int_{0}^{\pi} x \mathrm{d}f(x) \\
    &= \pi f(\pi) - \displaystyle\int_{0}^{\pi} x \cdot \dfrac{\sin x}{\pi - x} \mathrm{d}x \\
    &= \pi \displaystyle\int_{0}^{\pi} \dfrac{\sin t}{\pi - t} \mathrm{d}t - \displaystyle\int_{0}^{\pi} \dfrac{x \sin x}{\pi - x} \mathrm{d}x \\
    &= \displaystyle\int_{0}^{\pi} \dfrac{(\pi - x) \sin x}{\pi - x} \mathrm{d}x = \displaystyle\int_{0}^{\pi} \sin x \mathrm{d}x = 2
    \end{aligned}
    $$

**类题 1**

设 $f(x)=\displaystyle\int_{1}^{x} \dfrac{\ln(1+t)}{t} \mathrm{d}t$，计算 $\displaystyle\int_{0}^{1} \dfrac{f(x)}{\sqrt{x}} \mathrm{d}x$

!!! success

    $$
    \begin{aligned}
    \displaystyle\int_{0}^{1} \dfrac{f(x)}{\sqrt{x}} \mathrm{d}x &= 2\displaystyle\int_{0}^{1} f(x) \mathrm{d}\sqrt{x} = 2\sqrt{x} f(x) \bigg|_{0}^{1} - 2\displaystyle\int_{0}^{1} \sqrt{x} \mathrm{d}f(x) \\
    &= -2 \displaystyle\int_{0}^{1} \sqrt{x} \dfrac{\ln(1+x)}{x} \mathrm{d}x \xrightarrow{x \to x^2} -4 \displaystyle\int_{0}^{1} \ln(1+x^2) \mathrm{d}x \\
    &= -4 \ln 2 + 8 \displaystyle\int_{0}^{1} \dfrac{x^2}{1+x^2} \mathrm{d}x = 8 - 2\pi - 4\ln 2
    \end{aligned}
    $$

**类题 2**

设 $f''(x)=\arctan(x-1)^2$，且 $f(0)=0$，求 $I=\displaystyle\int_{0}^{1} f(x) \mathrm{d}x$

!!! success

    $$
    \begin{aligned}
    \displaystyle\int_{0}^{1} f(x) \mathrm{d}x &= xf(x)\bigg|_0^1 - \displaystyle\int_{0}^{1} x \mathrm{d}f(x) = f(1) - \displaystyle\int_{0}^{1} x f'(x) \mathrm{d}x \\
    &= \displaystyle\int_{0}^{1} \arctan(x-1)^2 \mathrm{d}x - \displaystyle\int_{0}^{1} x \arctan(x-1)^2 \mathrm{d}x \\
    &\xrightarrow{(x-1)^2 \to x} \dfrac{1}{2} \displaystyle\int_{0}^{1} \arctan x \mathrm{d}x \\
    &= \dfrac{\pi}{8} - \dfrac{1}{2} \displaystyle\int_{0}^{1} \dfrac{x}{1+x^2} \mathrm{d}x = \dfrac{\pi}{8} - \dfrac{1}{4} \ln 2
    \end{aligned}
    $$

**类题 3**

已知函数 $f(x)$ 在 $\left[0, \dfrac{3}{2}\pi\right]$ 连续，在 $\left(0, \dfrac{3}{2}\pi\right)$ 内是 $\dfrac{\cos x}{2x - 3\pi}$ 的一个原函数，$f(0)=0$。

(1) 求 $f(x)$ 在 $\left[0, \dfrac{3}{2}\pi\right]$ 上的平均值。

(2) 证明 $f(x)$ 在 $\left(0, \dfrac{3}{2}\pi\right)$ 内有唯一零点。

!!! success

    **(1)**
    $f(x)$ 在 $\left[0, \dfrac{3}{2}\pi\right]$ 上的平均值为 $\overline{f(x)} = \dfrac{1}{\frac{3\pi}{2}} \displaystyle\int_{0}^{\frac{3\pi}{2}} f(x) \mathrm{d}x$。
    
    利用分部积分法计算定积分：

    $$
    \begin{aligned}
    \displaystyle\int_{0}^{\frac{3\pi}{2}} f(x) \mathrm{d}x &= x f(x) \bigg|_{0}^{\frac{3\pi}{2}} - \displaystyle\int_{0}^{\frac{3\pi}{2}} x \mathrm{d}f(x) \\
    &= \dfrac{3\pi}{2} f\left(\dfrac{3\pi}{2}\right) - 0 - \displaystyle\int_{0}^{\frac{3\pi}{2}} x \cdot \dfrac{\cos x}{2x - 3\pi} \mathrm{d}x \\
    &= \dfrac{3\pi}{2} \displaystyle\int_{0}^{\frac{3\pi}{2}} \dfrac{\cos t}{2t - 3\pi} \mathrm{d}t - \displaystyle\int_{0}^{\frac{3\pi}{2}} \dfrac{x \cos x}{2x - 3\pi} \mathrm{d}x \\
    &\xlongequal{\text{前项 } t \text{ 换为 } x} \displaystyle\int_{0}^{\frac{3\pi}{2}} \dfrac{\frac{3\pi}{2} \cos x}{2x - 3\pi} \mathrm{d}x - \displaystyle\int_{0}^{\frac{3\pi}{2}} \dfrac{x \cos x}{2x - 3\pi} \mathrm{d}x \\
    &= \displaystyle\int_{0}^{\frac{3\pi}{2}} \dfrac{\left(\frac{3\pi}{2} - x\right)\cos x}{2x - 3\pi} \mathrm{d}x = \displaystyle\int_{0}^{\frac{3\pi}{2}} \dfrac{-\frac{1}{2}(2x - 3\pi)\cos x}{2x - 3\pi} \mathrm{d}x \\
    &= -\dfrac{1}{2} \displaystyle\int_{0}^{\frac{3\pi}{2}} \cos x \mathrm{d}x
    \end{aligned}
    $$

    于是：

    $$
    \overline{f(x)} = \dfrac{2}{3\pi} \cdot \left( -\dfrac{1}{2} \displaystyle\int_{0}^{\frac{3\pi}{2}} \cos x \mathrm{d}x \right) = -\dfrac{1}{3\pi} \sin x \bigg|_{0}^{\frac{3\pi}{2}} = \dfrac{1}{3\pi}
    $$

    **(2)**
    令 $f'(x) = \dfrac{\cos x}{2x - 3\pi} = 0$，解得 $x=\dfrac{\pi}{2}$。
    于是 $f(x)$ 在 $\left(0, \dfrac{\pi}{2}\right)$ 内单调递减，在 $\left(\dfrac{\pi}{2}, \dfrac{3\pi}{2}\right)$ 内单调递增。

    由于$f(0) = 0\implies f\left(\dfrac{\pi}{2}\right)<f(0) = 0$

    若$f\left(\dfrac{3\pi}{2}\right)<0$，则与平均值大于$0$矛盾

    故$f(x)$在$(0,\dfrac{3\pi}{2})$有唯一零点

**例题 2**

设 $f(x)$ 为非负连续函数，满足 $f(x)\displaystyle\int_{0}^{x} f(x-t) \mathrm{d}t = \sin^4 x$，求 $\displaystyle\int_{0}^{\frac{\pi}{2}} f(x) \mathrm{d}x$

!!! success

    $$
    f(x)\displaystyle\int_{0}^{x} f(x-t) \mathrm{d}t \xlongequal{t \to x-t} f(x)\displaystyle\int_{0}^{x} f(t) \mathrm{d}t = \dfrac{1}{2} \dfrac{\mathrm{d}}{\mathrm{d}x} \left( \displaystyle\int_{0}^{x} f(t) \mathrm{d}t \right)^2 = \cos^4 x
    $$

    于是

    $$
    \left( \displaystyle\int_{0}^{x} f(t) \mathrm{d}t \right)^2 = 2 \displaystyle\int_{0}^{x} \cos^4 t \mathrm{d}t
    $$

    令 $x = \dfrac{\pi}{2}$，得到 $\displaystyle\int_{0}^{\frac{\pi}{2}} f(t) \mathrm{d}t = \sqrt{\dfrac{3\pi}{8}}$。（非负连续函数积分值为正）

**类题**

设 $f(x)$ 为连续函数，且 $x > -1$ 时， $f(x) \left[ \displaystyle\int_{0}^{x} f(t) \mathrm{d}t + 1 \right] = \dfrac{x e^x}{2(1+x)^2}$，求 $f(x)$

!!! success

    $$
    \dfrac{1}{2} \dfrac{\mathrm{d}}{\mathrm{d}x} \left[ \displaystyle\int_{0}^{x} f(t) \mathrm{d}t + 1 \right]^2 = \dfrac{x e^x}{2(1+x)^2}
    $$

    于是

    $$
    \left( \displaystyle\int_{0}^{x} f(t) \mathrm{d}t + 1 \right)^2 - 1 = 2\displaystyle\int_{0}^{x} \dfrac{t e^t}{2(1+t)^2} \mathrm{d}t = \dfrac{e^x}{x+1} - 1
    $$

    $$
    \displaystyle\int_{0}^{x} f(t) \mathrm{d}t = -1 \pm \sqrt{\dfrac{e^x}{x+1}}
    $$

    求导：$f(x) = \pm \dfrac{x}{2x+2} \sqrt{\dfrac{e^x}{x+1}}$

### 被积函数中含有导函数的定积分计算

**例题**

设 $\displaystyle\int_{0}^{2} f(x) \mathrm{d}x = 4$， $f(2)=1$， $f'(2)=0$，求 $\displaystyle\int_{0}^{1} x^2 f''(2x) \mathrm{d}x$

!!! success

    $$
    \begin{aligned}
    \displaystyle\int_{0}^{1} x^2 f''(2x) \mathrm{d}x &\xlongequal{2x \to x} \dfrac{1}{8} \displaystyle\int_{0}^{2} x^2 f''(x) \mathrm{d}x = \dfrac{1}{8} \displaystyle\int_{0}^{2} x^2 \mathrm{d}f'(x) \\
    &= -\dfrac{1}{4} \displaystyle\int_{0}^{2} x f'(x) \mathrm{d}x = -\dfrac{1}{4} \displaystyle\int_{0}^{2} x \mathrm{d}f(x) = \dfrac{1}{2}
    \end{aligned}
    $$


### 利用“定积分的结果是一个数字”来求解某些待定函数的问题

**例题 1**

设 $f(x)=x^2 - x \displaystyle\int_{0}^{2} f(x) \mathrm{d}x + 2\displaystyle\int_{0}^{1} f(x) \mathrm{d}x$，求 $f(x)$

!!! success

    设 $\displaystyle\int_{0}^{2} f(x) \mathrm{d}x = a$, $\displaystyle\int_{0}^{1} f(x) \mathrm{d}x = b$，则 $f(x) = x^2 - ax + 2b$。
    代入积分计算：

    $$
    a = \displaystyle\int_{0}^{2} (x^2 - ax + 2b) \mathrm{d}x = \dfrac{8}{3} - 2a + 4b
    $$

    $$
    b = \displaystyle\int_{0}^{1} (x^2 - ax + 2b) \mathrm{d}x = \dfrac{1}{3} - \dfrac{a}{2} + 2b
    $$

    联立解得 $a = \dfrac{4}{3}, b = \dfrac{1}{3}$，所以 $f(x) = x^2 - \dfrac{4}{3}x + \dfrac{2}{3}$。

**例题 2**

设 $f(x)$ 为连续函数， $f(x) = \dfrac{x}{1+\cos^2 x} + \displaystyle\int_{-\pi}^{\pi} f(x) \sin x \mathrm{d}x$，求 $f(x)$

!!! success

    设 $\displaystyle\int_{-\pi}^{\pi} f(x) \sin x \mathrm{d}x = a$，则 $f(x) = \dfrac{x}{1+\cos^2 x} + a$。

    $$
    a = \displaystyle\int_{-\pi}^{\pi} \left( \dfrac{x}{1+\cos^2 x} + a \right) \sin x \mathrm{d}x = \displaystyle\int_{-\pi}^{\pi} \dfrac{x \sin x}{1+\cos^2 x} \mathrm{d}x + a \displaystyle\int_{-\pi}^{\pi} \sin x \mathrm{d}x
    $$

    第二项为0，第一项利用偶函数性质：

    $$
    a = 2 \displaystyle\int_{0}^{\pi} \dfrac{x \sin x}{1+\cos^2 x} \mathrm{d}x = \dfrac{\pi^2}{2}
    $$

    因此 $f(x) = \dfrac{x}{1+\cos^2 x} + \dfrac{\pi^2}{2}$。

**例题 3**

连续函数 $f$ 和 $g$ 满足 $f(x)=3x^2 + 1 + \displaystyle\int_{0}^{1} g(x) \mathrm{d}x$, $g(x)=-x + 6x^2 \displaystyle\int_{0}^{1} f(x) \mathrm{d}x$，求 $f(x), g(x)$

!!! success

    设 $\displaystyle\int_{0}^{1} f(x) \mathrm{d}x = a$, $\displaystyle\int_{0}^{1} g(x) \mathrm{d}x = b$。

    则 $f(x) = 3x^2 + 1 + b$, $g(x) = -x + 6ax^2$。
    积分得方程组：

    $$
    a = \displaystyle\int_{0}^{1} (3x^2 + 1 + b) \mathrm{d}x = 2 + b
    $$

    $$
    b = \displaystyle\int_{0}^{1} (-x + 6ax^2) \mathrm{d}x = -\dfrac{1}{2} + 2a
    $$

    解得 $a = -\dfrac{3}{2}, b = -\dfrac{7}{2}$。

    因此 $f(x) = 3x^2 - \dfrac{5}{2}, g(x) = -9x^2 - x$。

### 利用分部积分，导出积分的递推公式

**例题 1**

华里士公式 (Wallis formula)：
$I_n = \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^n x \mathrm{d}x = \displaystyle\int_{0}^{\frac{\pi}{2}} \cos^n x \mathrm{d}x = \dfrac{(n-1)!!}{n!!} I^*$
其中 $I^* = \dfrac{\pi}{2}$ (n为偶数)，$I^* = 1$ (n为奇数)。

**例题 2**

求积分 $J_n = \displaystyle\int_{0}^{1} x \ln^n x \mathrm{d}x$ 的递推关系，并计算 $J_n$

!!! success

    $$
    J_n = \displaystyle\int_{0}^{1} \ln^n x \mathrm{d}\left(\dfrac{x^2}{2}\right) = \dfrac{1}{2} x^2 \ln^n x \bigg|_{0}^{1} - \dfrac{n}{2} \displaystyle\int_{0}^{1} x \ln^{n-1} x \mathrm{d}x = -\dfrac{n}{2} J_{n-1} \quad (n \ge 1)
    $$

    依次相乘得到 $J_n = \left(-\dfrac{1}{2}\right)^n n! J_0$。

    而 $J_0 = \displaystyle\int_{0}^{1} x \mathrm{d}x = \dfrac{1}{2}$，因此 $J_n = (-1)^n \dfrac{n!}{2^{n+1}}$。

**例题 3**

设 $J_n = \displaystyle\int_{0}^{\frac{\pi}{4}} \tan^n x \mathrm{d}x$，判断 $J_n$ 的单调性，并利用分部积分导出 $J_n$ 和 $J_{n+2}$ 的递推关系，并计算 $\lim\limits_{n \to \infty} n J_n$

!!! success

    在积分区间 $\left(0, \dfrac{\pi}{4}\right)$ 内，$\tan x \in (0, 1)$，于是 $\tan^n x$ 为正且单调递减，故 $J_n$ 单调递减。

    $$
    J_{n+2} = \displaystyle\int_{0}^{\frac{\pi}{4}} \tan^n x (\sec^2 x - 1) \mathrm{d}x = \displaystyle\int_{0}^{\frac{\pi}{4}} \tan^n x \mathrm{d} \tan x - J_n = \dfrac{1}{n+1} - J_n
    $$

    即递推关系为 $J_n + J_{n+2} = \dfrac{1}{n+1}$。

    $J_n$ 单调递减且有下界0，故极限存在。在递推关系中令 $n \to \infty$，得 $\lim\limits_{n \to \infty} J_n = 0$

    $$
    \lim\limits_{n \to \infty} n J_n = \dfrac{1}{2} \lim_{n \to \infty} [n J_n + (n+2) J_{n+2}] = \dfrac{1}{2} \lim_{n \to \infty} \dfrac{n}{n+1} = \dfrac{1}{2}
    $$

**例题 4**

设 $a_n = \displaystyle\int_{0}^{1} x^n \sqrt{1-x^2} \mathrm{d}x$, $b_n = \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^n x \cdot \cos^n x \mathrm{d}x$，求 $\lim_{n \to \infty} \dfrac{b_n}{a_n}$

!!! success

    $$
    a_n \xlongequal{x \to \sin x} \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^n x \cos^2 x \mathrm{d}x = \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^n x \mathrm{d}x - \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^{n+2} x \mathrm{d}x
    $$

    $$
    b_n = \dfrac{1}{2^n} \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^n(2x) \mathrm{d}x = \dfrac{1}{2^n} \displaystyle\int_{0}^{\frac{\pi}{2}} \sin^n x \mathrm{d}x
    $$

    通过比较 Wallis 公式的比值极限，最终可得 $\lim_{n \to \infty} \dfrac{b_n}{a_n} = 0$。

**例题 5**

证明：$J_n = \displaystyle\int_{0}^{\frac{\pi}{2}} \cos^n x \cdot \sin nx \mathrm{d}x = \dfrac{1}{2^{n+1}} \left( 2 + \dfrac{2^2}{2} + \dfrac{2^3}{3} + \dots + \dfrac{2^n}{n} \right)$

!!! success

    考虑到 $\cos^n x = \left( \dfrac{e^{ix} + e^{-ix}}{2} \right)^n$，展开整理后可得：

    $$
    J_n = \dfrac{1}{2^n} \sum_{k=0}^{n} C_n^k \displaystyle\int_{0}^{\frac{\pi}{2}} \sin nx \cos(n-2k)x \mathrm{d}x
    $$

    通过积化和差及区间再现等技巧计算每一项积分，最终求和得到结论。

### 分段函数的定积分

**例题 1**

设 $f(x) = \displaystyle\int_{0}^{1} |t^2 - x^2| \mathrm{d}t (x>0)$，求 $f'(x)$ 并求 $f(x)$ 的最小值。

!!! success

    $$
    f(x) = \begin{cases}
    \displaystyle\int_{0}^{x} (x^2 - t^2) \mathrm{d}t + \displaystyle\int_{x}^{1} (t^2 - x^2) \mathrm{d}t = \dfrac{4}{3}x^3 - x^2 + \dfrac{1}{3}, & (0 < x < 1) \\
    \displaystyle\int_{0}^{1} (x^2 - t^2) \mathrm{d}t = x^2 - \dfrac{1}{3}, & (x \ge 1)
    \end{cases}
    $$

    求导得：

    $$
    f'(x) = \begin{cases}
    4x^2 - 2x, & (0 < x < 1) \\
    2x, & (x \ge 1)
    \end{cases}
    $$

    令 $f'(x)=0$ 得 $x=\dfrac{1}{2}$。$f(x)$ 在 $\left(0, \dfrac{1}{2}\right)$ 减，在 $\left(\dfrac{1}{2}, +\infty\right)$ 增。

    最小值 $f\left(\dfrac{1}{2}\right) = \dfrac{1}{4}$。

**例题 2**

设 $f(x) = \begin{cases} 2x + \dfrac{3}{2}x^2, & 0 \le x < 1 \\ \dfrac{1+x}{x(1+xe^x)}, & 1 \le x \le 2 \end{cases}$，求函数 $F(x) = \displaystyle\int_{0}^{x} f(t) \mathrm{d}t$ 的表达式。

!!! success
    当 $0 \le x < 1$ 时， $F(x) = x^2 + \dfrac{1}{2}x^3$。

    当 $1 \le x \le 2$ 时，

    $$
    F(x) = \dfrac{3}{2} + \displaystyle\int_{1}^{x} \dfrac{1+t}{t(1+te^t)} \mathrm{d}t = \dfrac{3}{2} + \displaystyle\int_{1}^{x} \dfrac{\mathrm{d}(te^t)}{te^t(1+te^t)} = \dfrac{1}{2} + \ln(1+e) + \ln\left(\dfrac{xe^x}{1+xe^x}\right)
    $$

**例题 3**

已知 $x \ge 0$ 时， $f(x) = \begin{cases} \sin x, & 0 \le x < \dfrac{\pi}{2} \\ 0, & x \ge \dfrac{\pi}{2} \end{cases}$，且 $g(x) = \begin{cases} 1, & x \ge 0 \\ 0, & x < 0 \end{cases}$，求 $F(x) = \displaystyle\int_{0}^{x} f(t)g(x-t) \mathrm{d}t (x \ge 0)$

!!! success

    当 $0 \le x < \dfrac{\pi}{2}$ 时， $F(x) = \displaystyle\int_{0}^{x} (x-t) \sin t \mathrm{d}t = x - \sin x$。

    当 $x \ge \dfrac{\pi}{2}$ 时， $F(x) = \displaystyle\int_{0}^{\frac{\pi}{2}} (x-t) \sin t \mathrm{d}t = x - 1$。