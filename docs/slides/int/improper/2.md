# 反常积分的计算

## 一、积分区间内部如果存在瑕点，则需要拆区间

若瑕点在积分区间内部，则需先从瑕点处拆开，将原积分拆成两个积分，分别计算再相加即可。

**例题 1** $\displaystyle\int_{1/2}^{3/2} \dfrac{1}{\sqrt{|x-x^2|}} \mathrm{d}x$

**解**：由于 $x-x^2 = x(1-x)$ 在区间 $[1/2, 3/2]$ 内，当 $x \in [1/2, 1)$ 时为正，当 $x \in (1, 3/2]$ 时为负，且 $x=1$ 是瑕点。

$$
\begin{aligned}
I &= \displaystyle\int_{1/2}^{1} \dfrac{1}{\sqrt{x-x^2}} \mathrm{d}x + \displaystyle\int_{1}^{3/2} \dfrac{1}{\sqrt{x^2-x}} \mathrm{d}x \\
&= \displaystyle\int_{1/2}^{1} \dfrac{\mathrm{d}\left(x-\frac{1}{2}\right)}{\sqrt{\frac{1}{4} - \left(x-\frac{1}{2}\right)^2}} + \displaystyle\int_{1}^{3/2} \dfrac{\mathrm{d}\left(x-\frac{1}{2}\right)}{\sqrt{\left(x-\frac{1}{2}\right)^2 - \frac{1}{4}}} \\
&= \arcsin \dfrac{x-\frac{1}{2}}{\frac{1}{2}} \Bigg|_{1/2}^{1^-} + \ln\left( x-\frac{1}{2} + \sqrt{x^2-x} \right) \Bigg|_{1^+}^{3/2} \\
&= \left( \dfrac{\pi}{2} - 0 \right) + \ln \dfrac{1+\sqrt{\frac{9}{4}-\frac{3}{2}}}{\frac{1}{2}} \\
&= \dfrac{\pi}{2} + \ln(2+\sqrt{9-6}) = \dfrac{\pi}{2} + \ln(2+\sqrt{3})
\end{aligned}
$$

---

## 二、将反常积分拆成两个积分计算时，需要考虑每个积分的敛散性

**例题 2** $\displaystyle\int_{1}^{+\infty} \dfrac{1}{x(x^2+1)} \mathrm{d}x$

**解**：利用裂项（部分分式分解）：

$$
\begin{aligned}
I &= \lim\limits_{b \to +\infty} \displaystyle\int_{1}^{b} \dfrac{x}{x^2(x^2+1)} \mathrm{d}x = \lim\limits_{b \to +\infty} \displaystyle\int_{1}^{b} x \left( \dfrac{1}{x^2} - \dfrac{1}{x^2+1} \right) \mathrm{d}x \\
&= \lim\limits_{b \to +\infty} \left[ \ln x - \dfrac{1}{2}\ln(1+x^2) \right] \Bigg|_{1}^{b} \\
&= \lim\limits_{b \to +\infty} \left[ \ln \dfrac{b}{\sqrt{1+b^2}} - \left( -\dfrac{1}{2}\ln 2 \right) \right] = \dfrac{\ln 2}{2}
\end{aligned}
$$

---

## 三、反常积分的分部积分，也需要考虑每一项的敛散性

**例题 3** $\displaystyle\int_{0}^{+\infty} \dfrac{x e^{-x}}{(1+e^{-x})^2} \mathrm{d}x$

**解法一**：先算不定积分：

$$
I_0 = \displaystyle\int \dfrac{x e^{-x}}{(1+e^{-x})^2} \mathrm{d}x = \displaystyle\int x \mathrm{d}\left( \dfrac{1}{e^{-x}+1} \right) = \dfrac{x}{e^{-x}+1} - \displaystyle\int \dfrac{1}{e^{-x}+1} \mathrm{d}x = \dfrac{x}{e^{-x}+1} - \displaystyle\int \dfrac{e^x}{1+e^x} \mathrm{d}x = \dfrac{x}{e^{-x}+1} - \ln(1+e^x)
$$

则，

$$
I = \left[ \dfrac{x}{e^{-x}+1} - \ln(1+e^x) \right] \Bigg|_{0}^{+\infty} = \ln 2 + \lim\limits_{x \to +\infty} \left[ \dfrac{x}{e^{-x}+1} - \ln(1+e^x) \right] = \ln 2
$$

**解法二**：注意分部积分时的边界项处理（为了使其收敛，凑常数 -1）：

$$
\begin{aligned}
I &= \displaystyle\int_{0}^{+\infty} x \mathrm{d}\left( \dfrac{1}{e^{-x}+1} - 1 \right) = -\displaystyle\int_{0}^{+\infty} x \mathrm{d}\left( \dfrac{e^{-x}}{e^{-x}+1} \right) \\
&= x \left( \dfrac{1}{e^{-x}+1} - 1 \right) \Bigg|_{0}^{+\infty} - \displaystyle\int_{0}^{+\infty} \left( \dfrac{1}{e^{-x}+1} - 1 \right) \mathrm{d}x \\
&= \left[ -\dfrac{x e^{-x}}{1+e^{-x}} \right] \Bigg|_{0}^{+\infty} + \displaystyle\int_{0}^{+\infty} \dfrac{e^{-x}}{e^{-x}(1+e^x)} \mathrm{d}x = 0 + \displaystyle\int_{0}^{+\infty} \dfrac{1}{e^x+1} \mathrm{d}x \\
&= \ln 2 \quad (\text{注：此处积分计算同上})
\end{aligned}
$$

*注：解法二中，$\mathrm{d}(\frac{1}{e^{-x}+1})$ 等同于 $\mathrm{d}(\frac{1}{e^{-x}+1} - 1)$，减去 1 是为了让边界项 $x \cdot (\dots)$ 在 $+\infty$ 处趋于 0 而非无穷。*

**解法三**：转化为 $e^x$ 的形式：

$$
I = \displaystyle\int_{0}^{+\infty} \dfrac{x e^x}{(e^x+1)^2} \mathrm{d}x = -\displaystyle\int_{0}^{+\infty} x \mathrm{d}\dfrac{1}{e^x+1} = - \dfrac{x}{e^x+1} \Bigg|_{0}^{+\infty} + \displaystyle\int_{0}^{+\infty} \dfrac{1}{e^x+1} \mathrm{d}x = \ln \dfrac{e^x}{e^x+1} \Bigg|_{0}^{+\infty} = \ln 2
$$

---

## 四、无穷区间上的区间再现公式

对于有限区间上的积分，实现区间再现的方法是直接使用区间再现公式，也就是令 $x+t=a+b$。
而对于无穷区间，尤其是 $(0, +\infty)$，我们可采用倒代换的方法，令 $x=\dfrac{1}{t}$，便可实现区间再现。
也可以是将 $(0, +\infty)$ 拆成 $(0, 1)$ 和 $(1, +\infty)$，然后对 $(1, +\infty)$ 倒代换，从而将 $(1, +\infty)$ 变回 $(0, 1)$。
也可以三角换元，令 $x=\tan t$，这样就将 $x \in (0, +\infty)$ 变成了 $t \in (0, \dfrac{\pi}{2})$，然后再用区间再现即可。

**例题 4** $\displaystyle\int_{0}^{+\infty} \dfrac{1}{(1+x^2)(1+x^\alpha)} \mathrm{d}x$，其中 $\alpha$ 是参数。

**解法一**：倒代换

$$
\text{令 } x=\dfrac{1}{t} \implies I = \displaystyle\int_{+\infty}^{0} \dfrac{1}{(1+\frac{1}{t^2})(1+\frac{1}{t^\alpha})} \left(-\dfrac{1}{t^2}\right) \mathrm{d}t = \displaystyle\int_{0}^{+\infty} \dfrac{t^\alpha}{(t^2+1)(t^\alpha+1)} \mathrm{d}t
$$

$$
2I = \displaystyle\int_{0}^{+\infty} \dfrac{1}{(1+x^2)(1+x^\alpha)} \mathrm{d}x + \displaystyle\int_{0}^{+\infty} \dfrac{x^\alpha}{(x^2+1)(x^\alpha+1)} \mathrm{d}x = \displaystyle\int_{0}^{+\infty} \dfrac{1+x^\alpha}{(1+x^2)(1+x^\alpha)} \mathrm{d}x
$$

$$
2I = \displaystyle\int_{0}^{+\infty} \dfrac{1}{x^2+1} \mathrm{d}x = \arctan x \Bigg|_{0}^{+\infty} = \dfrac{\pi}{2} \implies I = \dfrac{\pi}{4}
$$

**解法二**：三角换元

$$
\text{令 } x=\tan t \implies I = \displaystyle\int_{0}^{\frac{\pi}{2}} \dfrac{1}{\sec^2 t (1+\tan^\alpha t)} \sec^2 t \mathrm{d}t = \displaystyle\int_{0}^{\frac{\pi}{2}} \dfrac{\cos^\alpha t}{\cos^\alpha t + \sin^\alpha t} \mathrm{d}t
$$

$$
= \displaystyle\int_{0}^{\frac{\pi}{2}} \dfrac{\sin^\alpha t}{\sin^\alpha t + \cos^\alpha t} \mathrm{d}t = \dfrac{1}{2} \displaystyle\int_{0}^{\frac{\pi}{2}} \mathrm{d}t = \dfrac{\pi}{4}
$$

**例题 5** $\displaystyle\int_{0}^{+\infty} \dfrac{\ln x}{1+x^2} \mathrm{d}x$

**解法一**：倒代换

$$
I = \displaystyle\int_{0}^{+\infty} \dfrac{\ln x}{1+x^2} \mathrm{d}x \xlongequal{x=\frac{1}{t}} \displaystyle\int_{+\infty}^{0} \dfrac{-\ln t}{1+\frac{1}{t^2}} \left(-\dfrac{1}{t^2}\right) \mathrm{d}t = \displaystyle\int_{0}^{+\infty} \dfrac{-\ln t}{t^2+1} \mathrm{d}t = -I \implies I = 0
$$

**解法二**：三角换元

$$
\text{令 } x=\tan t, I = \displaystyle\int_{0}^{\frac{\pi}{2}} \dfrac{\ln \tan t}{\sec^2 t} \cdot \sec^2 t \mathrm{d}t = \displaystyle\int_{0}^{\frac{\pi}{2}} \ln \tan t \mathrm{d}t = \displaystyle\int_{0}^{\frac{\pi}{2}} \ln \cot t \mathrm{d}t = \dfrac{1}{2} \displaystyle\int_{0}^{\frac{\pi}{2}} \ln(\tan t \cdot \cot t) \mathrm{d}t = 0
$$

**类题** $\displaystyle\int_{0}^{+\infty} \dfrac{\ln x}{a^2+x^2} \mathrm{d}x \quad (a>0)$

**三角换元**

$$
\text{令 } x=a \tan t \implies I = \displaystyle\int_{0}^{\frac{\pi}{2}} \dfrac{\ln(a \tan t)}{a^2 \sec^2 t} \cdot a \sec^2 t \mathrm{d}t = \int_{0}^{\frac{\pi}{2}} \dfrac{\ln a + \ln \tan t}{a} \mathrm{d}t = \dfrac{\pi}{2} \cdot \dfrac{\ln a}{a} + \dfrac{1}{a} \displaystyle\int_{0}^{\frac{\pi}{2}} \ln \tan t \mathrm{d}t = \dfrac{\pi \ln a}{2a}
$$

**倒代换**

$$
\text{令 } x=\dfrac{a}{t} \implies I = \displaystyle\int_{+\infty}^{0} \dfrac{\ln \frac{a}{t}}{a^2+\frac{a^2}{t^2}} \left(-\dfrac{a}{t^2}\right) \mathrm{d}t = \dfrac{1}{a} \displaystyle\int_{0}^{+\infty} \dfrac{\ln a - \ln t}{t^2+1} \mathrm{d}t
$$

$$
= \dfrac{\ln a}{a} \displaystyle\int_{0}^{+\infty} \dfrac{1}{t^2+1} \mathrm{d}t = \dfrac{\pi}{2} \cdot \dfrac{\ln a}{a}
$$

---

**例题 6** $\displaystyle\int_{0}^{+\infty} \dfrac{\ln x}{1+x+x^2} \mathrm{d}x$

**解**：

$$
\text{令 } x=\dfrac{1}{t}, I = \displaystyle\int_{+\infty}^{0} \dfrac{-\ln t}{1+\frac{1}{t}+\frac{1}{t^2}} \left(-\dfrac{1}{t^2}\right) \mathrm{d}t = \displaystyle\int_{0}^{+\infty} \dfrac{-\ln t}{t^2+t+1} \mathrm{d}t = -I \implies I = 0
$$

---

**类题** $\displaystyle\int_{0}^{+\infty} \dfrac{\ln(1-x+x^2)}{(1+x^2) \ln x} \mathrm{d}x$

**解**：

$$
\text{令 } x=\dfrac{1}{t} \implies I = \displaystyle\int_{+\infty}^{0} \dfrac{\ln(1-\frac{1}{t}+\frac{1}{t^2})}{(1+\frac{1}{t^2})(-\ln t)} \cdot \left(-\dfrac{1}{t^2}\right) \mathrm{d}t = -\displaystyle\int_{0}^{+\infty} \dfrac{\ln \frac{t^2-t+1}{t^2}}{(t^2+1)\ln t} \mathrm{d}t
$$

$$
= -\displaystyle\int_{0}^{+\infty} \dfrac{\ln(t^2-t+1)-2\ln t}{(t^2+1)\ln t} \mathrm{d}t = -I + 2\displaystyle\int_{0}^{+\infty} \dfrac{1}{1+t^2} \mathrm{d}t \implies I = \displaystyle\int_{0}^{+\infty} \dfrac{1}{1+x^2} \mathrm{d}x = \dfrac{\pi}{2}
$$